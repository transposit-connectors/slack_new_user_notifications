{
  "v2": {
    "transposit": {
      "dependencies": [{
        "name": "transposit/slack:v1.*.*",
        "alias": "slack"
      }, {
        "name": "transposit/slack:v1.*.*",
        "alias": "slackbot"
      }],
      "operations": [{
        "id": "post_tos",
        "description": "Posts the TOS to the User's channel",
        "tql": {
          "parameters": [{
            "name": "userid",
            "type": "STRING"
          }, {
            "name": "message",
            "type": "STRING"
          }],
          "tql": "SELECT * FROM slackbot.post_chat_message\n  WHERE $body=(SELECT {\n  \t'link_names' : true,\n    'channel' : @userid,\n  \t'text' : @message,\n  \t'as_user': true,\n    'attachments' : [{\n      'title': 'What is Slack?',\n      'text': 'Slack is where work happens. If this is your first time using Slack, take some time to read the help docs at get.slack.help and our internal wiki. If you have any questions, jump into #help-slack and we\\'ll help you out',\n      'color': '#74c8ed',\n    },\n    {\n      'title': 'Code of Conduct',\n      'text': 'Our goal is to maintain a safe, helpful and friendly community for everyone, regardless of experience, gender identity and expression, sexual orientation, disability, personal appearance, body size, race, ethnicity, age, religion, nationality, or other defining characteristic. Please take the time to read through <https://code.localhost|Code of Conduct> before continuing.',\n      'callback_id': 'terms-of-service',\n      'color': '#3060f0',\n      'actions': [{\n        'name': 'accept',\n        'text': 'Accept',\n        'type': 'button',\n        'value': 'accept',\n        'style': 'primary',\n      }],\n    }]\n  })\n"
        }
      }, {
        "id": "newuser",
        "description": "Activates upon a new user joining slack",
        "function": {
          "parameters": [{
            "name": "http_event",
            "default": {
              "text": "{\"http_method\": \"GET\", \"query_parameters\": {}, \"headers\": {}, \"body\": \"\"}"
            },
            "type": "OBJECT"
          }],
          "js": "webhook.js"
        },
        "access": {
          "requireApiKey": true,
          "webhook": true
        }
      }, {
        "id": "acceptpush",
        "description": "Activates when a button is pushed",
        "function": {
          "parameters": [{
            "name": "http_event",
            "default": {
              "text": "{\"http_method\": \"GET\", \"query_parameters\": {}, \"headers\": {}, \"body\": \"\"}"
            },
            "type": "OBJECT"
          }],
          "js": "accepttos.js"
        },
        "access": {
          "requireApiKey": true,
          "webhook": true
        }
      }, {
        "id": "reminder",
        "description": "A reminder to accept that runs as a scheduled task",
        "function": {
          "js": "reminder.js"
        }
      }, {
        "id": "create_record",
        "description": "Creates the new user record",
        "tql": {
          "parameters": [{
            "name": "id",
            "type": "STRING"
          }],
          "tql": "SELECT * FROM airtable.create_record\n  WHERE baseId='appxd7g7VAj6gcz6x'\t\t-- Change this to your airtable baseId\n  AND table='Users'\n  AND $body=(SELECT {\n    'fields' : {'slackId': @id, 'accepted': false },\n  })\n"
        }
      }, {
        "id": "get_records",
        "description": "Returns all records in Airtable",
        "tql": {
          "tql": "SELECT * FROM airtable.get_records\n  WHERE baseId='appxd7g7VAj6gcz6x'\t\t-- Change this to your airtable baseId\n  AND table='Users'\n"
        }
      }],
      "dataConnections": [{
        "ref": "slack.raw",
        "overrides": {
          "swagger": {
            "oauthConfig": {
            },
            "executionLimits": {
            }
          }
        }
      }, {
        "ref": "slackbot.raw",
        "overrides": {
          "swagger": {
            "oauthConfig": {
              "scope": "bot",
              "accessTokenPath": "bot.bot_access_token"
            },
            "executionLimits": {
            }
          }
        }
      }],
      "javascriptAPIVersion": "3",
      "source": "src",
      "userSettingsDisplay": "GENERATED"
    }
  }
}